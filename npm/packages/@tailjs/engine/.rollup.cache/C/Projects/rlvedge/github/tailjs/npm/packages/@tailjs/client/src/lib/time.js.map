{"version":3,"file":"time.js","sourceRoot":"","sources":["time.ts"],"names":[],"mappings":"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","sourcesContent":["import { Timestamp } from \"@tailjs/types\";\nimport { F, SSR, T, nil, performance, promise, setTimeout, undefined } from \".\";\n\nexport const now: (truncate?: boolean) => number = (\n  round = T,\n  _tmp?: number\n) => (\n  (_tmp = SSR ? Date.now() : performance.timeOrigin + performance.now()),\n  round ? Math.trunc(_tmp) : _tmp\n);\n\nexport type Timeout = {\n  (): void; // Clear\n  (callback: () => void, delay?: number): void;\n  clear(delay?: number, cleanup?: () => void): void;\n  wait(delay?: number): Promise<void>;\n  isActive(): boolean;\n  finish(): void;\n  pulse(): Timeout;\n};\n\nexport const delay = (ms: number): Promise<void> =>\n  promise((resolve) => setTimeout(resolve, ms));\n\nexport const formatDuration = (ms: number) =>\n  ms > 250 ? `${(ms / 1000).toFixed(2)}s` : `${Math.round(ms)}ms`;\n\nexport const timeout = (callback?: () => void, delay?: number): Timeout => {\n  let id = 0;\n  let currentCallback = callback;\n  let capturedCallback: typeof callback | null = null;\n\n  const clear = () => (\n    (currentCallback = undefined),\n    id < 0 ? clearInterval(-id) : clearTimeout(id),\n    (id = 0)\n  );\n\n  const timeout = (callback?: () => void, delay?: number) => {\n    clear();\n    if (!callback) return;\n\n    currentCallback = callback;\n    id =\n      delay! < 0\n        ? -setInterval(callback, -delay!)\n        : setTimeout(() => ((currentCallback = undefined), callback()), delay);\n  };\n\n  timeout.clear = (delay?: number, cleanup?: () => void, currentId = id) =>\n    id &&\n    (delay\n      ? setTimeout(() => id === currentId && (clear(), cleanup?.()), delay)\n      : (clear(), cleanup?.()));\n\n  timeout.wait = (delay: number): Promise<void> =>\n    promise((resolve) => timeout(resolve, delay));\n\n  timeout.pulse = () => (currentCallback?.(), timeout);\n\n  timeout.isActive = () => currentCallback != nil;\n  timeout.finish = () =>\n    (capturedCallback = currentCallback) && (clear(), capturedCallback());\n\n  return callback && timeout(callback, delay), timeout;\n};\n\nexport const timer = (time = () => now(), started = T) => {\n  let elapsed = 0;\n  let origin = started ? time() : 0;\n\n  const timer = (start?: boolean): Timestamp => {\n    if (origin) {\n      elapsed += -origin + (origin = time());\n    } else if (start === T) {\n      origin = time();\n    }\n\n    if (start === F) {\n      origin = 0;\n    }\n    return elapsed;\n  };\n  timer.reset = () => (origin && (origin = time()), (elapsed = 0));\n  return timer;\n};\n\nexport const defer = (f: VoidFunction, ms = 0) =>\n  ms ? setTimeout(f, ms) : window.queueMicrotask(f);\n"]}